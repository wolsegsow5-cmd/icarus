<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PumpSim Pro - Mum GrafiÄŸi</title>
    <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <style>
        :root {
            --primary: #14F195;
            --secondary: #9945FF;
            --bg: #131722; /* TradingView Koyu Arka Plan */
            --panel: #1e222d;
            --text: #c5c6c7;
            --up-color: #26a69a; /* GerÃ§ekÃ§i YeÅŸil */
            --down-color: #ef5350; /* GerÃ§ekÃ§i KÄ±rmÄ±zÄ± */
        }
        body { font-family: 'Inter', 'Segoe UI', sans-serif; background-color: var(--bg); color: var(--text); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        .header { width: 100%; max-width: 900px; display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; background: var(--panel); border-radius: 12px; margin-bottom: 20px; box-sizing: border-box; }
        .logo { font-size: 1.5em; font-weight: bold; color: white; display: flex; align-items: center; gap: 10px; }
        .logo span { background: var(--primary); color: black; padding: 2px 8px; border-radius: 5px; font-size: 0.8em; }
        .wallet { background: #131722; padding: 10px 15px; border-radius: 8px; font-family: monospace; font-size: 1.2em; border: 1px solid #2a2e39; color: white; }
        
        .container { width: 100%; max-width: 900px; background: var(--panel); padding: 20px; border-radius: 12px; box-sizing: border-box; border: 1px solid #2a2e39; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        
        /* Kurulum EkranÄ± */
        #setupScreen { display: block; text-align: center; padding: 50px 20px; }
        .input-group { margin: 25px 0; }
        input[type="text"] { width: 70%; padding: 15px; border-radius: 8px; border: 2px solid #2a2e39; background: #131722; color: white; font-size: 1.5em; text-align: center; outline: none; text-transform: uppercase; font-weight: bold; }
        input[type="text"]:focus { border-color: var(--primary); }
        .btn-launch { background: var(--primary); color: #000; font-weight: bold; font-size: 1.3em; padding: 15px 50px; border: none; border-radius: 8px; cursor: pointer; transition: 0.3s; margin-top: 10px; }
        .btn-launch:hover { background: #10c97c; transform: translateY(-2px); }

        /* Borsa EkranÄ± */
        #marketScreen { display: none; }
        .market-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 15px; }
        .coin-info { text-align: left; }
        .coin-title { font-size: 2em; font-weight: 900; color: white; }
        .price-display { font-size: 1.8em; color: var(--up-color); font-family: monospace; font-weight: bold; }
        
        /* Profesyonel Grafik AlanÄ± */
        #tvchart { width: 100%; height: 400px; background: #131722; border: 1px solid #2a2e39; border-radius: 8px; overflow: hidden; }

        .action-panel { display: flex; gap: 15px; margin-top: 20px; }
        .trade-box { flex: 1; background: #131722; padding: 20px; border-radius: 8px; border: 1px solid #2a2e39; text-align: center; }
        .btn { width: 100%; padding: 15px; font-size: 1.2em; font-weight: bold; border: none; border-radius: 8px; cursor: pointer; color: white; text-transform: uppercase; margin-top: 10px; }
        .btn-buy { background: var(--up-color); }
        .btn-buy:hover { background: #33b5a5; }
        .btn-sell { background: var(--down-color); }
        .btn-sell:hover { background: #f0625d; }
        
        .balance-info { font-size: 0.9em; color: #888; margin-bottom: 5px; }
    </style>
</head>
<body>

    <div class="header">
        <div class="logo">ðŸ’Š PumpSim <span>PRO</span></div>
        <div class="wallet">USD: <span id="cash" style="color: var(--primary);">2000.00</span> $</div>
    </div>

    <div class="container" id="setupScreen">
        <h2 style="color: white; font-size: 2em; margin-bottom: 5px;">ðŸš€ Projeyi BaÅŸlat</h2>
        <p style="color: #888;">Solana aÄŸÄ±nda lansman simÃ¼lasyonu</p>
        <div class="input-group">
            <input type="text" id="tokenName" value="PUMA" placeholder="Ã–rn: DUCKCOIN" autocomplete="off" maxlength="10">
        </div>
        <button class="btn-launch" onclick="startMarket()">Piyasaya SÃ¼r</button>
    </div>

    <div class="container" id="marketScreen">
        <div class="market-header">
            <div class="coin-info">
                <div class="coin-title" id="marketTokenName">COIN / USD</div>
                <div class="balance-info" id="tokenBalanceDisplay">CÃ¼zdan: 0 Adet</div>
            </div>
            <div class="price-display">$<span id="tokenPrice">0.001000</span></div>
        </div>
        
        <div id="tvchart"></div>

        <div class="action-panel">
            <div class="trade-box">
                <div class="balance-info">AlÄ±nacak Tutar: $100</div>
                <button class="btn btn-buy" onclick="executeBuy()">AL</button>
            </div>
            <div class="trade-box">
                <div class="balance-info">TÃ¼mÃ¼nÃ¼ Sat</div>
                <button class="btn btn-sell" onclick="executeSell()">SAT</button>
            </div>
        </div>
    </div>

<script>
    let cashBalance = 2000.00;
    let tokensOwned = 0;
    let currentPrice = 0.001000; 
    let activeToken = "";
    
    // Grafik DeÄŸiÅŸkenleri
    let chart;
    let candleSeries;
    let volumeSeries;
    let currentCandle;

    function refreshUI() {
        document.getElementById('cash').innerText = cashBalance.toFixed(2);
        
        let priceEl = document.getElementById('tokenPrice');
        priceEl.innerText = currentPrice.toFixed(6);
        // Fiyata gÃ¶re renk deÄŸiÅŸtir
        priceEl.style.color = currentCandle && currentCandle.close >= currentCandle.open ? 'var(--up-color)' : 'var(--down-color)';
        
        document.getElementById('tokenBalanceDisplay').innerText = "CÃ¼zdan: " + Math.floor(tokensOwned).toLocaleString() + " " + activeToken;
    }

    function startMarket() {
        const inputVal = document.getElementById('tokenName').value.trim();
        activeToken = inputVal === "" ? "TOKEN" : inputVal.toUpperCase();
        
        document.getElementById('marketTokenName').innerText = activeToken + " / USD";
        document.getElementById('setupScreen').style.display = 'none';
        document.getElementById('marketScreen').style.display = 'block';

        initTradingViewChart();
        refreshUI();
        
        // Her 2 saniyede bir piyasa hareket etsin
        setInterval(autoMoveMarket, 2000);
        // Her 5 saniyede bir yeni mum (candle) oluÅŸtur
        setInterval(createNewCandle, 5000);
    }

    function initTradingViewChart() {
        const chartContainer = document.getElementById('tvchart');
        
        chart = LightweightCharts.createChart(chartContainer, {
            width: chartContainer.clientWidth,
            height: 400,
            layout: {
                background: { type: 'solid', color: '#131722' },
                textColor: '#d1d4dc',
            },
            grid: {
                vertLines: { color: '#2a2e39' },
                horzLines: { color: '#2a2e39' },
            },
            crosshair: {
                mode: LightweightCharts.CrosshairMode.Normal,
            },
            timeScale: {
                timeVisible: true,
                secondsVisible: false,
            },
        });

        // Mum Serisi (Candlestick)
        candleSeries = chart.addCandlestickSeries({
            upColor: '#26a69a',
            downColor: '#ef5350',
            borderDownColor: '#ef5350',
            borderUpColor: '#26a69a',
            wickDownColor: '#ef5350',
            wickUpColor: '#26a69a',
        });

        // BaÅŸlangÄ±Ã§ Mumu
        currentCandle = {
            time: Math.floor(Date.now() / 1000),
            open: currentPrice,
            high: currentPrice,
            low: currentPrice,
            close: currentPrice
        };
        candleSeries.update(currentCandle);
    }

    function updatePrice(newPrice) {
        currentPrice = newPrice;
        
        // Mevcut mumu (candle) gÃ¼ncelle
        currentCandle.close = currentPrice;
        if (currentPrice > currentCandle.high) currentCandle.high = currentPrice;
        if (currentPrice < currentCandle.low) currentCandle.low = currentPrice;
        
        candleSeries.update(currentCandle);
        refreshUI();
    }

    function createNewCandle() {
        // ZamanÄ± ileri al ve yeni mumu aÃ§
        let nextTime = Math.floor(Date.now() / 1000);
        if (nextTime <= currentCandle.time) nextTime = currentCandle.time + 1; // Ã‡akÄ±ÅŸmayÄ± Ã¶nle

        currentCandle = {
            time: nextTime,
            open: currentPrice,
            high: currentPrice,
            low: currentPrice,
            close: currentPrice
        };
        candleSeries.update(currentCandle);
    }

    function executeBuy() {
        if (cashBalance >= 100) {
            let received = 100 / currentPrice;
            cashBalance -= 100;
            tokensOwned += received;
            
            // Pump etkisi (%2 ile %8 arasÄ± sert yÃ¼kseliÅŸ)
            let newPrice = currentPrice * (1 + (Math.random() * 0.06 + 0.02)); 
            updatePrice(newPrice);
        } else {
            alert("Bakiye yetersiz!");
        }
    }

    function executeSell() {
        if (tokensOwned > 0) {
            let cashEarned = tokensOwned * currentPrice;
            cashBalance += cashEarned;
            tokensOwned = 0;
            
            // Dump etkisi (%3 ile %12 arasÄ± sert dÃ¼ÅŸÃ¼ÅŸ)
            let newPrice = currentPrice * (1 - (Math.random() * 0.09 + 0.03));
            if(newPrice < 0.000001) newPrice = 0.000001; 
            updatePrice(newPrice);
        } else {
            alert("SatÄ±lacak token yok!");
        }
    }

    function autoMoveMarket() {
        // DoÄŸal dalgalanma motoru (Botlar al-sat yapÄ±yor hissi)
        let volatility = 1 + (Math.random() * 0.02 - 0.01); // %1 yukarÄ± veya aÅŸaÄŸÄ±
        updatePrice(currentPrice * volatility);
    }
</script>

</body>
</html>
